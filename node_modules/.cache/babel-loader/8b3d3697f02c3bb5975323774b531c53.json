{"ast":null,"code":"import axios from 'axios';\nimport { useCookies } from 'vue3-cookies';\nimport { api_url } from '../../utils/const';\nexport default {\n  name: 'Login',\n  props: {\n    ws: WebSocket\n  },\n\n  setup() {\n    const {\n      cookies\n    } = useCookies();\n    return {\n      cookies\n    };\n  },\n\n  data() {\n    return {\n      username: '',\n      password: '',\n      error: false,\n      errorMsg: ''\n    };\n  },\n\n  mounted() {\n    if (this.$store.state.curUser != null) {\n      this.$router.push('home');\n    }\n  },\n\n  methods: {\n    async handleSubmit() {\n      try {\n        // e.preventDefault();\n        const response = await axios.post(`${api_url}/users/login`, {\n          username: this.username,\n          passwd: this.password\n        });\n        this.cookies.set('token', response.data.data);\n        this.$store.getters.socket.sendObj({\n          type: 'login',\n          args: [response.data.data]\n        });\n        this.$router.push('home');\n      } catch (err) {\n        console.log(err);\n        const msgs = err.response.data.message.split(':');\n        this.error = true;\n        this.errorMsg = msgs[msgs.length - 1];\n      }\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAwCA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,UAAT,QAA2B,cAA3B;AACA,SAASC,OAAT,QAAwB,mBAAxB;AAEA,eAAe;AACbC,MAAI,EAAE,OADO;AAEbC,OAAK,EAAE;AACLC,MAAE,EAAEC;AADC,GAFM;;AAKbC,OAAK,GAAG;AACN,UAAM;AAAEC;AAAF,QAAcP,UAAU,EAA9B;AACA,WAAO;AAAEO;AAAF,KAAP;AACD,GARY;;AASbC,MAAI,GAAG;AACL,WAAO;AACLC,cAAQ,EAAE,EADL;AAELC,cAAQ,EAAE,EAFL;AAGLC,WAAK,EAAE,KAHF;AAILC,cAAQ,EAAE;AAJL,KAAP;AAMD,GAhBY;;AAiBbC,SAAO,GAAG;AACR,QAAI,KAAKC,MAAL,CAAYC,KAAZ,CAAkBC,OAAlB,IAA6B,IAAjC,EAAuC;AACrC,WAAKC,OAAL,CAAaC,IAAb,CAAkB,MAAlB;AACF;AACD,GArBY;;AAsBbC,SAAO,EAAE;AACP,UAAMC,YAAN,GAAqB;AACnB,UAAI;AACF;AACA,cAAMC,QAAO,GAAI,MAAMtB,KAAK,CAACuB,IAAN,CAAY,GAAErB,OAAQ,cAAtB,EAAqC;AAC1DQ,kBAAQ,EAAE,KAAKA,QAD2C;AAE1Dc,gBAAM,EAAE,KAAKb;AAF6C,SAArC,CAAvB;AAIA,aAAKH,OAAL,CAAaiB,GAAb,CAAiB,OAAjB,EAA0BH,QAAQ,CAACb,IAAT,CAAcA,IAAxC;AACA,aAAKM,MAAL,CAAYW,OAAZ,CAAoBC,MAApB,CAA2BC,OAA3B,CAAmC;AACjCC,cAAI,EAAE,OAD2B;AAEjCC,cAAI,EAAE,CAACR,QAAQ,CAACb,IAAT,CAAcA,IAAf;AAF2B,SAAnC;AAKA,aAAKS,OAAL,CAAaC,IAAb,CAAkB,MAAlB;AACF,OAbA,CAaE,OAAOY,GAAP,EAAY;AACZC,eAAO,CAACC,GAAR,CAAYF,GAAZ;AACA,cAAMG,IAAG,GAAIH,GAAG,CAACT,QAAJ,CAAab,IAAb,CAAkB0B,OAAlB,CAA0BC,KAA1B,CAAgC,GAAhC,CAAb;AACA,aAAKxB,KAAL,GAAa,IAAb;AACA,aAAKC,QAAL,GAAgBqB,IAAI,CAACA,IAAI,CAACG,MAAL,GAAc,CAAf,CAApB;AACF;AACD;;AArBM;AAtBI,CAAf","names":["axios","useCookies","api_url","name","props","ws","WebSocket","setup","cookies","data","username","password","error","errorMsg","mounted","$store","state","curUser","$router","push","methods","handleSubmit","response","post","passwd","set","getters","socket","sendObj","type","args","err","console","log","msgs","message","split","length"],"sourceRoot":"","sources":["/Users/macbookpro/Documents/projects/windzo/src/views/Login.vue"],"sourcesContent":["<template>\n  <div class=\"container\">\n    <div class=\"form-login form-wrap\">\n      <form @submit.prevent=\"handleSubmit\">\n        <h3>Login</h3>\n        <div v-show=\"error\" class=\"alert alert-danger\" role=\"alert\">\n          {{ errorMsg }}\n        </div>\n        <div class=\"form-group\">\n          <label for=\"username\">Username</label>\n          <input\n            type=\"text\"\n            id=\"username\"\n            name=\"username\"\n            class=\"form-control\"\n            v-model=\"username\"\n            placeholder=\"Username\"\n            required\n          />\n        </div>\n        <div class=\"form-group\">\n          <label for=\"\">Password</label>\n          <input\n            type=\"password\"\n            class=\"form-control\"\n            v-model=\"password\"\n            placeholder=\"Password\"\n            required\n          />\n        </div>\n        <div class=\"form-group\">\n          <button class=\"btn btn-primary btn-block\">Login</button>\n          Don't have an account yet?\n          <router-link to=\"/register\">Create a new account</router-link>\n        </div>\n      </form>\n    </div>\n  </div>\n</template>\n<script>\nimport axios from 'axios';\nimport { useCookies } from 'vue3-cookies';\nimport { api_url } from '../../utils/const';\n\nexport default {\n  name: 'Login',\n  props: {\n    ws: WebSocket,\n  },\n  setup() {\n    const { cookies } = useCookies();\n    return { cookies };\n  },\n  data() {\n    return {\n      username: '',\n      password: '',\n      error: false,\n      errorMsg: '',\n    };\n  },\n  mounted() {\n    if (this.$store.state.curUser != null) {\n      this.$router.push('home');\n    }\n  },\n  methods: {\n    async handleSubmit() {\n      try {\n        // e.preventDefault();\n        const response = await axios.post(`${api_url}/users/login`, {\n          username: this.username,\n          passwd: this.password,\n        });\n        this.cookies.set('token', response.data.data);\n        this.$store.getters.socket.sendObj({\n          type: 'login',\n          args: [response.data.data],\n        });\n\n        this.$router.push('home');\n      } catch (err) {\n        console.log(err);\n        const msgs = err.response.data.message.split(':');\n        this.error = true;\n        this.errorMsg = msgs[msgs.length - 1];\n      }\n    },\n  },\n};\n</script>\n\n<style scoped>\n.btn {\n  margin-right: 10px;\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}